#!/usr/bin/env bash

set -eu

if [[ ! -f /etc/code-server/pass ]]; then
	mkdir -p /etc/code-server

	touch /etc/code-server/pass
	chmod 0600 /etc/code-server/pass

	cat /dev/urandom | head -c 8 | base64 >> /etc/code-server/pass
fi

PASSWORD=$(cat /etc/code-server/pass) /usr/local/lib/code-server/code-server --cert --port 443 --host 0.0.0.0